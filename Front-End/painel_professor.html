<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Painel do Professor</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&display=swap");

      body {
        background-image: url(../images/unisc_fundo.jpg);
        background-size: cover;
        font-family: "Roboto Condensed", sans-serif;
        font-weight: 600;
        margin: 0;
        padding: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
      }

      .container {
        width: 90vw;
        max-width: 1200px;
        background: white;
        border: 6px solid #0044cc;
        border-radius: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .header {
        text-align: center;
        margin-bottom: 20px;
        width: 100%;
      }

      .header img {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        border: 2px solid #ccc;
        cursor: pointer;
        object-fit: cover;
      }

      .header h2 {
        margin: 10px 0 0 0;
        font-size: 24px;
        font-weight: bold;
      }

      .user-role {
        font-size: 16px;
        color: #555;
        margin-bottom: 15px;
      }

      .role-selection {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 20px;
        font-weight: bold;
      }

      .role-selection label {
        display: flex;
        align-items: center;
        gap: 5px;
        cursor: pointer;
      }

      .role-selection input[type="checkbox"] {
        transform: scale(1.2);
        cursor: pointer;
      }

      .tabs {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 15px;
        border-bottom: 2px solid #ccc;
        margin-bottom: 20px;
        padding-bottom: 10px;
        width: 100%;
      }

      .tab {
        cursor: pointer;
        font-weight: bold;
        padding: 10px 15px;
        color: #333;
        border-radius: 5px;
        transition: all 0.3s ease;
      }

      .tab.active {
        color: #0044cc;
        border-bottom: 3px solid #0044cc;
        background-color: #e0e8f0;
      }

      .tab-content {
        display: none;
        width: 100%;
        padding: 15px;
        border: 1px solid #eee;
        border-radius: 10px;
        background-color: #f9f9f9;
      }

      .tab-content.active {
        display: block;
      }

      .feature-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }

      .feature-card {
        background-color: #fff;
        border: 1px solid #e0e0e0;
        border-radius: 10px;
        padding: 15px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        text-align: center;
        transition: transform 0.2s ease-in-out;
        cursor: pointer;
      }

      .feature-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
      }

      .feature-card i {
        font-size: 30px;
        margin-bottom: 10px;
        color: #0044cc;
      }

      .feature-card h3 {
        font-size: 18px;
        margin: 0;
        color: #333;
      }

      .coordenador-only {
        border: 2px dashed #ff9800;
        background-color: #fff8e1;
      }

      .coordenador-only h3 {
        color: #f57c00;
      }

      .form-section {
        margin-bottom: 20px;
      }

      .form-section label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
        color: #555;
      }

      .form-section input[type="text"],
      .form-section input[type="date"],
      .form-section input[type="number"],
      .form-section textarea,
      .form-section select {
        width: calc(100% - 20px);
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        margin-bottom: 10px;
      }

      .form-section button {
        background-color: #0044cc;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        transition: background-color 0.3s ease;
      }

      .form-section button:hover {
        background-color: #003399;
      }

      .upload-section {
        text-align: center;
        padding: 20px;
        border: 2px dashed #ccc;
        border-radius: 10px;
        margin-top: 15px;
      }

      .upload-section input[type="file"] {
        margin-top: 10px;
      }

      .alert-item {
        background-color: #fff3e0;
        border-left: 5px solid #f57c00;
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 5px;
      }

      .alert-item strong {
        color: #e65100;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <label for="fotoInput">
          <img
            id="fotoUsuario"
            src="https://via.placeholder.com/80"
            alt="Foto do Usuário"
          />
        </label>
        <input
          type="file"
          id="fotoInput"
          accept="image/*"
          style="display: none"
        />
        <h2 id="nomeHeader">Nome do Professor</h2>
        <div class="user-role">Professor</div>
      </div>

      <div class="role-selection">
        <label>
          <input type="checkbox" id="checkboxCoordenador" /> Tornar Coordenador
        </label>
      </div>

      <div class="tabs">
        <div class="tab active" onclick="showTab('gerenciar_alunos')">
          Gerenciar Alunos
        </div>
        <div class="tab" onclick="showTab('definir_banca')">
          Definir Banca
        </div>
        <div class="tab" onclick="showTab('gerenciar_professores')">
          Gerenciar Professores
        </div>
        <div class="tab" onclick="showTab('relatorios_notas')">
          Notas e Avaliações
        </div>
        <div class="tab" onclick="showTab('cronograma')">Cronograma</div>
        <div class="tab" onclick="showTab('reunioes')">Reuniões</div>
        <div class="tab" onclick="showTab('prazos_alertas')">
          Prazos e Alertas
        </div>
      </div>

      <div id="gerenciar_alunos" class="tab-content active">
        <h3>Cadastro de Alunos Matriculados no TC</h3>
        <div class="form-section">
          <label for="nomeAlunoMatriculado">Nome do Aluno:</label>
          <input
            type="text"
            id="nomeAlunoMatriculado"
            placeholder="Nome completo do aluno"
          />
          <label for="matriculaAluno">Matrícula:</label>
          <input
            type="text"
            id="matriculaAluno"
            placeholder="Número de matrícula"
          />
          <button onclick="cadastrarAluno()">Cadastrar Aluno</button>
        </div>
        <h4>Alunos Matriculados:</h4>
        <ul id="listaAlunosMatriculados"></ul>
        <div class="form-section">
          <label for="alunoSelecionado">Definir Aluno:</label>
          <select id="alunoSelecionado">
            <option value="">Selecione um aluno</option>
          </select>
          <label for="orientadorSelecionado">Orientador:</label>
          <select id="orientadorSelecionado">
            <option value="">Selecione um professor</option>
          </select>
          <button onclick="definirOrientador()">
            Definir Relação Aluno/Orientador
          </button>
        </div>
      </div>

      <div id="definir_banca" class="tab-content coordenador-only">
        <h3>Definição de Banca Examinadora</h3>
        <p>Apenas o Coordenador pode definir a banca.</p>
        <div class="form-section">
          <label for="alunoParaBanca">Aluno:</label>
          <select id="alunoParaBanca">
            <option value="">Selecione um aluno</option>
          </select>
          <label for="professorBanca1">Professor da Banca 1:</label>
          <select id="professorBanca1">
            <option value="">Selecione um professor</option>
          </select>
          <label for="professorBanca2">Professor da Banca 2:</label>
          <select id="professorBanca2">
            <option value="">Selecione um professor</option>
          </select>
          <button onclick="definirBanca()">Definir Banca</button>
        </div>
      </div>

      <div id="gerenciar_professores" class="tab-content">
        <h3>Cadastro de Professores</h3>
        <div class="form-section">
          <label for="nomeProfessor">Nome do Professor:</label>
          <input
            type="text"
            id="nomeProfessor"
            placeholder="Nome completo do professor"
          />
          <label for="disciplinaProfessor">Disciplina:</label>
          <input
            type="text"
            id="disciplinaProfessor"
            placeholder="Disciplina principal"
          />
          <button onclick="cadastrarProfessor()">Cadastrar Professor</button>
        </div>
        <h4>Professores Cadastrados:</h4>
        <ul id="listaProfessores"></ul>
      </div>

      <div id="relatorios_notas" class="tab-content">
        <h3>Lançamento de Notas por Critério</h3>
        <div class="form-section">
          <label for="alunoParaNota">Aluno:</label>
          <select id="alunoParaNota">
            <option value="">Selecione um aluno</option>
          </select>
          <label for="criterioNota">Critério de Avaliação:</label>
          <select id="criterioNota">
            <option value="proposta">Proposta</option>
            <option value="reelaboracao_proposta">
              Reelaboração Proposta
            </option>
            <option value="tc">Trabalho de Conclusão (TC)</option>
            <option value="reelaboracao_tc">Reelaboração de TC</option>
          </select>
          <div id="notasPorCriterio"></div>
          <button onclick="lancarNotas()">Lançar Notas</button>
        </div>
        </div>

      <div id="cronograma" class="tab-content">
        <h3 class="coordenador-only">
          Definição do Cronograma de Entregas (Coordenador)
        </h3>
        <div class="form-section coordenador-only">
          <label for="tipoEntregaCronograma">Tipo de Entrega:</label>
          <select id="tipoEntregaCronograma">
            <option value="proposta">Proposta</option>
            <option value="reelaboracao_proposta">
              Reelaboração Proposta
            </option>
            <option value="tc">Trabalho de Conclusão (TC)</option>
            <option value="reelaboracao_tc">Reelaboração de TC</option>
          </select>
          <label for="dataEntregaCronograma">Data de Entrega:</label>
          <input type="date" id="dataEntregaCronograma" />
          <label for="horaEntregaCronograma">Horário de Entrega:</label>
          <input type="time" id="horaEntregaCronograma" />
          <button onclick="definirCronograma()">Definir Prazo</button>
        </div>
      </div>

      <div id="reunioes" class="tab-content">
        <h3>Registro de Reuniões de Orientação</h3>
        <div class="form-section">
          <label for="alunoReuniao">Aluno:</label>
          <select id="alunoReuniao">
            <option value="">Selecione um aluno</option>
          </select>
          <label for="dataReuniao">Data da Reunião:</label>
          <input type="date" id="dataReuniao" />
          <label for="observacoesReuniao">Observações:</label>
          <textarea
            id="observacoesReuniao"
            rows="4"
            placeholder="Detalhes da reunião..."
          ></textarea>
          <div class="upload-section">
            <label for="documentoReuniao">Upload de Documentos:</label>
            <input type="file" id="documentoReuniao" />
            <button onclick="registrarReuniao()">Registrar Reunião</button>
          </div>
        </div>
        <h4>Reuniões Registradas:</h4>
        <ul id="listaReunioes"></ul>
      </div>

      <div id="prazos_alertas" class="tab-content">
        <h3>Controle de Prazos e Tempos de Avaliação</h3>
        <div class="form-section">
          <p><strong>Prazos de Entrega Definidos:</strong></p>
          <ul id="listaPrazosEntrega"></ul>
        </div>
        <div class="form-section">
          <p><strong>Tempos de Avaliação Definidos:</strong></p>
          <ul id="listaTemposAvaliacao"></ul>
        </div>
        <div class="form-section">
          <h3>Alertas de Atraso</h3>
          <div id="alertasAtraso">
            <p class="alert-item">
              <strong>Atenção:</strong> O aluno [Nome do Aluno] está com a
              entrega da Proposta atrasada.
            </p>
            <p class="alert-item">
              <strong>Atenção:</strong> O prazo para avaliação da Reelaboração
              de TC do aluno [Nome do Aluno] expirou.
            </p>
          </div>
        </div>
      </div>
    </div>
    <script>
    function showTab(tabId) {
        document.querySelectorAll(".tab-content").forEach((tab) => {
            tab.classList.remove("active");
        });
        document.querySelectorAll(".tab").forEach((tab) => {
            tab.classList.remove("active");
        });
        const activeTab = document.getElementById(tabId);
        activeTab.classList.add("active");
        document.querySelector(`[onclick="showTab('${tabId}')"]`).classList.add("active");

        if (tabId === 'definir_banca') {
            toggleCoordenadorFeatures(true);
        } else {
            toggleCoordenadorFeatures(false);
        }
    }

    function toggleCoordenadorFeatures(forceShow = false) {
        const isCoordenador = document.getElementById("checkboxCoordenador").checked || (usuarioLogado && usuarioLogado.tipo === "coordenador");
        
        document.querySelectorAll(".coordenador-only").forEach((el) => {
            el.style.display = (isCoordenador && forceShow) ? "block" : "none";
        });

        if (isCoordenador) {
            document.querySelector(".user-role").textContent = "Coordenador";
        } else {
            document.querySelector(".user-role").textContent = "Professor";
        }
    }

    const fotoInput = document.getElementById("fotoInput");
    const fotoUsuario = document.getElementById("fotoUsuario");
    fotoInput.addEventListener("change", function () {
        const file = this.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
                fotoUsuario.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
    });

    const usuarioLogado = JSON.parse(localStorage.getItem("usuarioLogado"));

    document.addEventListener("DOMContentLoaded", () => {
        if (!usuarioLogado) {
            alert("Usuário não logado!");
            window.location.href = "login.html";
            return;
        }

        document.getElementById("nomeHeader").textContent = usuarioLogado.nome;
        if (usuarioLogado.foto) {
            document.getElementById("fotoUsuario").src = usuarioLogado.foto;
        }

        if (usuarioLogado.tipo === "coordenador" || usuarioLogado.eh_coordenador) {
            document.getElementById("checkboxCoordenador").checked = true;
            document.querySelector(".user-role").textContent = "Coordenador";
        }

        loadProfessorFeatures();
        toggleCoordenadorFeatures(false);
        loadDataForTabs();
    });

    document.getElementById("checkboxCoordenador").addEventListener("change", async function () {
        const isCoordenador = this.checked;
        const novoTipo = isCoordenador ? "coordenador" : "professor";

        try {
            const response = await fetch("http://localhost:3000/api/atualizar-tipo", {
                method: "PUT",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    id: usuarioLogado.id,
                    tipo: novoTipo
                })
            });

            const result = await response.json();

            if (response.ok) {
                usuarioLogado.tipo = novoTipo;
                localStorage.setItem("usuarioLogado", JSON.stringify(usuarioLogado));

                alert(result.message);
            } else {
                this.checked = !isCoordenador;
                alert(`Erro ao atualizar: ${result.error}`);
            }
        } catch (error) {
            console.error("Erro de conexão com o servidor:", error);
            this.checked = !isCoordenador;
            alert("Não foi possível conectar ao servidor para atualizar sua função.");
        }

        const activeTabId = document.querySelector('.tab-content.active').id;
        toggleCoordenadorFeatures(activeTabId === 'definir_banca');
    });

    async function cadastrarAluno() {
        const nome = document.getElementById("nomeAlunoMatriculado").value;
        const matricula = document.getElementById("matriculaAluno").value;

        const senha = prompt("Digite uma senha para o novo aluno:", "123456");

        if (!nome || !matricula || !senha) {
            alert("Por favor, preencha o nome, a matrícula e a senha do aluno.");
            return;
        }

        try {
            const response = await fetch("http://localhost:3000/api/alunos", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ nome, matricula, senha }),
            });

            const result = await response.json();

            if (response.ok) {
                alert(result.message);
                document.getElementById("nomeAlunoMatriculado").value = "";
                document.getElementById("matriculaAluno").value = "";
                loadAlunosMatriculados();
                loadAlunosForSelect();
            } else {
                alert(`Erro: ${result.error}`);
            }
        } catch (error) {
            console.error("Erro ao cadastrar aluno:", error);
            alert("Não foi possível conectar ao servidor.");
        }
    }

    function definirOrientador() {
        const alunoId = document.getElementById("alunoSelecionado").value;
        const orientadorId = document.getElementById("orientadorSelecionado").value;
        if (alunoId && orientadorId) {
            console.log(`Definindo orientador ${orientadorId} para o aluno ${alunoId}`);
            alert("Relação Aluno/Orientador definida com sucesso!");
        } else {
            alert("Por favor, selecione um aluno e um orientador.");
        }
    }

    async function cadastrarProfessor() {
        const nome = document.getElementById("nomeProfessor").value;
        const disciplina = document.getElementById("disciplinaProfessor").value;
        const senha = prompt("Digite uma senha para o novo professor:", "123456");

        if (!nome || !disciplina || !senha) {
            alert("Por favor, preencha o nome, a disciplina e a senha do professor.");
            return;
        }

        try {
            const response = await fetch("http://localhost:3000/api/professores", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ nome, disciplina, senha }),
            });

            const result = await response.json();

            if (response.ok) {
                alert(result.message);
                document.getElementById("nomeProfessor").value = "";
                document.getElementById("disciplinaProfessor").value = "";
                loadProfessores();
                loadProfessoresForSelect();
            } else {
                alert(`Erro: ${result.error}`);
            }
        } catch (error) {
            console.error("Erro ao cadastrar professor:", error);
            alert("Não foi possível conectar ao servidor.");
        }
    }

    async function lancarNotas() {
      const alunoId = document.getElementById("alunoParaNota").value;
      const criterio = document.getElementById("criterioNota").value;

      if (!alunoId || !criterio) {
          alert("Por favor, selecione um aluno e um critério.");
          return;
      }

      const dadosNotas = [];
      const inputs = document.querySelectorAll("#notasPorCriterio input");

      if (inputs.length === 0) {
          alert("Nenhum campo de nota para lançar.");
          return;
      }

      inputs.forEach(input => {
          const nota = parseFloat(input.value);
          if (!isNaN(nota)) {
              dadosNotas.push({
                  criterio: input.id, 
                  nota: nota
              });
          }
      });

      if (dadosNotas.length === 0) {
          alert("Por favor, insira pelo menos uma nota válida.");
          return;
      }

      try {
          const response = await fetch("http://localhost:3000/api/notas", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ alunoId, dadosNotas }),
          });

          const result = await response.json();

          if (response.ok) {
              alert(result.message);
              inputs.forEach(input => input.value = "");
          } else {
              alert(`Erro: ${result.error}`);
          }
      } catch (error) {
          console.error("Erro ao lançar notas:", error);
          alert("Não foi possível conectar ao servidor para lançar as notas.");
      }
  }

    async function definirBanca() {
      const alunoId = document.getElementById("alunoParaBanca").value;
      const professor1Id = document.getElementById("professorBanca1").value;
      const professor2Id = document.getElementById("professorBanca2").value;

      if (!alunoId || !professor1Id || !professor2Id) {
          alert("Por favor, selecione o aluno e os dois professores da banca.");
          return;
      }

      try {
          const response = await fetch("http://localhost:3000/api/bancas", {
              method: "POST",
              headers: {
                  "Content-Type": "application/json"
              },
              body: JSON.stringify({ alunoId, professor1Id, professor2Id })
          });

          const result = await response.json();

          if (response.ok) {
              alert(result.message);
              console.log(`Banca definida para o aluno ${alunoId} e salva no banco de dados.`);
          } else {
              alert(`Erro: ${result.error}`);
          }

      } catch (error) {
          console.error("Erro ao definir a banca:", error);
          alert("Não foi possível conectar ao servidor para definir a banca.");
      }
  }

    async function loadBanca() {
    const bancaInfo = document.getElementById('banca-info');
    bancaInfo.innerHTML = '';

    const usuario = JSON.parse(localStorage.getItem("usuarioLogado"));
    
    if (!usuario) {
        bancaInfo.innerHTML = '<p class="aviso-banca">Usuário não logado. Faça o login para ver a banca.</p>';
        return;
    }

    try {
        const response = await fetch(`http://localhost:3000/api/bancas/${usuario.id}`);
        const banca = await response.json();

        if (response.ok) {
            const prof1Nome = getProfessorNameById(banca.professor1_id);
            const prof2Nome = getProfessorNameById(banca.professor2_id);

            const professoresBanca = [
                { nome: prof1Nome, funcao: 'Professor(a) 1' },
                { nome: prof2Nome, funcao: 'Professor(a) 2' },
            ];

            professoresBanca.forEach(professor => {
                const li = document.createElement('li');
                li.innerHTML = `<strong>${professor.funcao}:</strong> ${professor.nome}`;
                bancaInfo.appendChild(li);
            });
        } else {
            const aviso = document.createElement('p');
            aviso.textContent = banca.error;
            aviso.classList.add('aviso-banca');
            bancaInfo.appendChild(aviso);
        }
    } catch (error) {
        console.error("Erro ao carregar a banca:", error);
        const aviso = document.createElement('p');
        aviso.textContent = 'Erro ao carregar a banca. Tente novamente mais tarde.';
        aviso.classList.add('aviso-banca');
        bancaInfo.appendChild(aviso);
    }
}

    function definirCronograma() {
        const tipoEntrega = document.getElementById("tipoEntregaCronograma").value;
        const dataEntrega = document.getElementById("dataEntregaCronograma").value;
        const horaEntrega = document.getElementById("horaEntregaCronograma").value;
        if (tipoEntrega && dataEntrega && horaEntrega) {
            console.log(`Definindo cronograma: ${tipoEntrega} para ${dataEntrega} às ${horaEntrega}`);
            alert("Prazo de entrega definido com sucesso!");
        } else {
            alert("Por favor, preencha todos os campos do cronograma.");
        }
    }

    function registrarReuniao() {
        const alunoId = document.getElementById("alunoReuniao").value;
        const dataReuniao = document.getElementById("dataReuniao").value;
        const observacoes = document.getElementById("observacoesReuniao").value;
        const documento = document.getElementById("documentoReuniao").files[0];

        if (alunoId && dataReuniao) {
            console.log("Registrando reunião:", alunoId, dataReuniao, observacoes, documento);
            alert("Reunião registrada com sucesso!");
            document.getElementById("alunoReuniao").value = "";
            document.getElementById("dataReuniao").value = "";
            document.getElementById("observacoesReuniao").value = "";
            document.getElementById("documentoReuniao").value = "";
            loadReunioes();
        } else {
            alert("Por favor, selecione um aluno e a data da reunião.");
        }
    }

    function loadProfessorFeatures() {
        console.log("Carregando funcionalidades específicas do professor...");
        loadProfessoresForSelect();
        loadAlunosForSelect();
    }

    function loadDataForTabs() {
        loadAlunosMatriculados();
        loadProfessores();
        loadPrazosAlertas();
        loadReunioes();
        generateNotasPorCriterioInputs();
    }

    async function loadAlunosMatriculados() {
        const listaAlunosEl = document.getElementById("listaAlunosMatriculados");
        listaAlunosEl.innerHTML = "<li>Carregando...</li>";
        try {
            const response = await fetch("http://localhost:3000/api/alunos");
            const alunos = await response.json();
            listaAlunosEl.innerHTML = "";
            if (alunos.length === 0) {
                listaAlunosEl.innerHTML = "<li>Nenhum aluno cadastrado.</li>";
                return;
            }
            alunos.forEach((aluno) => {
                const li = document.createElement("li");
                li.textContent = `${aluno.nome} (Matrícula: ${aluno.cpf})`;
                listaAlunosEl.appendChild(li);
            });
        } catch (error) {
            console.error("Erro ao buscar alunos:", error);
            listaAlunosEl.innerHTML = "<li>Erro ao carregar alunos.</li>";
        }
    }

    async function loadAlunosForSelect() {
        const selects = document.querySelectorAll("#alunoSelecionado, #alunoParaBanca, #alunoParaNota, #alunoReuniao");
        selects.forEach((select) => {
            select.innerHTML = '<option value="">Selecione um aluno</option>';
        });
        try {
            const response = await fetch("http://localhost:3000/api/alunos");
            const alunos = await response.json();
            selects.forEach((select) => {
                alunos.forEach((aluno) => {
                    const option = document.createElement("option");
                    option.value = aluno.id;
                    option.textContent = aluno.nome;
                    select.appendChild(option);
                });
            });
        } catch (error) {
            console.error("Erro ao carregar alunos para os selects:", error);
        }
    }

    async function loadProfessoresForSelect() {
        const selects = document.querySelectorAll("#orientadorSelecionado, #professorBanca1, #professorBanca2");
        selects.forEach((select) => {
            select.innerHTML = '<option value="">Selecione um professor</option>';
        });
        try {
            const response = await fetch("http://localhost:3000/api/professores");
            const professores = await response.json();
            selects.forEach((select) => {
                professores.forEach((professor) => {
                    const option = document.createElement("option");
                    option.value = professor.id;
                    option.textContent = professor.nome;
                    select.appendChild(option);
                });
            });
        } catch (error) {
            console.error("Erro ao carregar professores para os selects:", error);
        }
    }

    async function loadProfessores() {
        const listaProfessoresEl = document.getElementById("listaProfessores");
        listaProfessoresEl.innerHTML = "<li>Carregando...</li>";
        try {
            const response = await fetch("http://localhost:3000/api/professores");
            const professores = await response.json();
            listaProfessoresEl.innerHTML = "";
            if (professores.length === 0) {
                listaProfessoresEl.innerHTML = "<li>Nenhum professor cadastrado.</li>";
                return;
            }
            professores.forEach((prof) => {
                const li = document.createElement("li");
                li.textContent = `${prof.nome}`;
                listaProfessoresEl.appendChild(li);
            });
        } catch (error) {
            console.error("Erro ao buscar professores:", error);
            listaProfessoresEl.innerHTML = "<li>Erro ao carregar professores.</li>";
        }
    }

    function generateNotasPorCriterioInputs() {
      const container = document.getElementById("notasPorCriterio");
      const criterio = document.getElementById("criterioNota").value;

      container.innerHTML = "";

      let campos = [];
      let prefixoCriterio = "";
      switch (criterio) {
          case "proposta":
              campos = ["Qualidade da Proposta", "Originalidade", "Clareza"];
              prefixoCriterio = "proposta_";
              break;
          case "reelaboracao_proposta":
              campos = ["Atendimento às Correções", "Melhoria Geral", "Profundidade"];
              prefixoCriterio = "reelaboracao_proposta_";
              break;
          case "tc":
              campos = ["Conteúdo Técnico", "Estrutura do Trabalho", "Resultados"];
              prefixoCriterio = "tc_";
              break;
          case "reelaboracao_tc":
              campos = ["Correções Implementadas", "Qualidade da Apresentação", "Conclusões"];
              prefixoCriterio = "reelaboracao_tc_";
              break;
      }

      campos.forEach((campo) => {
          const idCampo = `${prefixoCriterio}${campo.toLowerCase().replace(/\s+/g, "_")}`;
          const div = document.createElement("div");
          div.innerHTML = `
              <label for="${idCampo}">${campo}:</label>
              <input
                  type="number"
                  id="${idCampo}"
                  min="0"
                  max="10"
                  step="0.5"
                  placeholder="Nota (0-10)"
              />
              `;
          container.appendChild(div);
      });
  }

    function loadPrazosAlertas() {
        console.log("Carregando prazos e alertas...");
        const listaPrazosEl = document.getElementById("listaPrazosEntrega");
        listaPrazosEl.innerHTML = "";
        const prazosExemplo = [
            { tipo: "Proposta", data: "20/10/2025", hora: "23:59" },
            { tipo: "TC", data: "15/12/2025", hora: "18:00" },
        ];
        prazosExemplo.forEach((prazo) => {
            const li = document.createElement("li");
            li.textContent = `${prazo.tipo}: ${prazo.data} às ${prazo.hora}`;
            listaPrazosEl.appendChild(li);
        });
    }

    function loadReunioes() {
        console.log("Carregando reuniões...");
        const listaReunioesEl = document.getElementById("listaReunioes");
        listaReunioesEl.innerHTML = "";
        const reunioesExemplo = [
            {
                aluno: "Aluno A",
                data: "10/09/2025",
                obs: "Discussão do escopo do projeto.",
            },
            {
                aluno: "Aluno B",
                data: "12/09/2025",
                obs: "Revisão da bibliografia.",
            },
        ];
        reunioesExemplo.forEach((reuniao) => {
            const li = document.createElement("li");
            li.innerHTML = `<strong>Aluno:</strong> ${reuniao.aluno} <br>
                    <strong>Data:</strong> ${reuniao.data} <br>
                    <strong>Obs:</strong> ${reuniao.obs}`;
            listaReunioesEl.appendChild(li);
        });
    }
    </script>
  </body>
</html>